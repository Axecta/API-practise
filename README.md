# README ‚Äî Multi-User Bridge (VK Teams ‚áÑ Telegram)

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Ñ–∞–π–ª—ã –º–µ–∂–¥—É **VK Teams (myteam/mail.ru bot API)** –∏ **Telegram-–±–æ—Ç–∞–º–∏**. –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è **–ª–∏—á–µ–∫** –∏ **–≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤** —Å –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π VK –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ Telegram –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

> TL;DR
>
> 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `node bridge.js`.
> 2. –í –õ–° VK-–±–æ—Ç–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ TG-–±–æ—Ç–∞.
> 3. –í Telegram –Ω–∞–∂–º–∏—Ç–µ **/start** –≤–∞—à–µ–º—É –±–æ—Ç—É (–∏/–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ –Ω—É–∂–Ω—ã–π –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç).
> 4. –í VK –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/list` ‚Üí `/to 1` ‚Üí –ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* üîÅ **–î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ—Å—ã–ª–∫–∞**: —Ç–µ–∫—Å—Ç –∏ —Ñ–∞–π–ª—ã VK ‚áÑ Telegram.
* üë• **–ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º**: –∫–∞–∂–¥—ã–π VK-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç ¬´—Å–≤–æ–π¬ª –º–æ—Å—Ç, –Ω–µ –º–µ—à–∞—è –¥—Ä—É–≥–∏–º.
* ü§ñ **–ù–µ—Å–∫–æ–ª—å–∫–æ Telegram-–±–æ—Ç–æ–≤**: –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ TG-—Ç–æ–∫–µ–Ω–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É polling-—Ü–∏–∫–ª—É –Ω–∞ —Ç–æ–∫–µ–Ω).
* üß† **–ê–≤—Ç–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∞–¥—Ä–µ—Å–∞—Ç–æ–≤ (auto-peer)**: –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥—è—â–∏–π –∞–ø–¥–µ–π—Ç –∏–∑ TG –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∞–¥—Ä–µ—Å–∞—Ç–∞ –∏ –≥–æ—Ç–æ–≤–∏—Ç –º–æ—Å—Ç.
* üßπ **–°–∞–º–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ 409**: –µ—Å–ª–∏ —É TG-–±–æ—Ç–∞ –≤–Ω–µ–∑–∞–ø–Ω–æ –≤–∫–ª—é—á–∏–ª—Å—è webhook ‚Äî –º–æ—Å—Ç –µ–≥–æ –æ—Ç–∫–ª—é—á–∏—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç polling.
* üóÇ **–ü–∞–º—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è**: `state.json` —Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π VK, —Å–ø–∏—Å–æ–∫ ¬´–∞–¥—Ä–µ—Å–∞—Ç–æ–≤¬ª TG –∏ —Å–º–µ—â–µ–Ω–∏—è polling.

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π TG ‚Üí VK: `photo`, `document`, `audio`, `voice`, `video`.
–í–ª–æ–∂–µ–Ω–∏—è VK ‚Üí TG –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `document`.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm i axios form-data
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –Ω–∞—á–∞–ª–µ `bridge.js`:

```js
const VK_BOT_TOKEN = '–í–ê–®_VK_BOT_TOKEN'; // ‚ö†Ô∏è –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π
const VK_API       = ''; // –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à endpoint
```

> –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏ —Å—á–∏—Ç—ã–≤–∞—Ç—å –∏—Ö –∏–∑ `process.env`, –∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å.

3. –ó–∞–ø—É—Å–∫:

```bash
node bridge.js
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º —Å—Ç–∞—Ä—Ç–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª—ë–Ω —Ñ–∞–π–ª `state.json`.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π)

* **VK-loop** –ø–æ–ª—É—á–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç VK-–±–æ—Ç–∞ (–õ–°/—á–∞—Ç).
  –ü–µ—Ä–≤—ã–π —à–∞–≥ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω —Å–≤–æ–µ–≥–æ **Telegram-–±–æ—Ç–∞** –≤ –õ–° VK-–±–æ—Ç—É.
  –ú–æ—Å—Ç –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏ –∂–¥—ë—Ç –ø–µ—Ä–≤–æ–≥–æ –∞–ø–¥–µ–π—Ç–∞ –∏–∑ Telegram.

* **TG-loop** (–Ω–∞ –∫–∞–∂–¥—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π TG —Ç–æ–∫–µ–Ω) –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –±–æ—Ç–∞ Telegram –≤ —Ä–µ–∂–∏–º **getUpdates** (—É–¥–∞–ª—è–µ—Ç webhook) –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç long-polling.
  –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∏–∑ Telegram –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–ª–∏—á–∫–∞ —Å –±–æ—Ç–æ–º / —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ, –≥–¥–µ –±–æ—Ç —Å–æ—Å—Ç–æ–∏—Ç), –º–æ—Å—Ç:

  * —Å–æ–∑–¥–∞—ë—Ç ¬´–∞–¥—Ä–µ—Å–∞—Ç–∞¬ª (`peer`) –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ VK;
  * –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ **ready**;
  * –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

* –î–∞–ª–µ–µ –ª—é–±—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è/—Ñ–∞–π–ª—ã –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –º–µ–∂–¥—É –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–∞—Ç–æ–º –≤ TG –∏ —Ç–µ–∫—É—â–∏–º –¥–∏–∞–ª–æ–≥–æ–º VK.

---

## –ö–æ–º–∞–Ω–¥—ã –≤ VK

–û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è **–≤ —á–∞—Ç VK**, –≥–¥–µ –≤—ã –æ–±—â–∞–µ—Ç–µ—Å—å —Å VK-–±–æ—Ç–æ–º.

* `/reset` ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å —Å–≤—è–∑–∫—É –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ VK-—á–∞—Ç–∞.
* `/list` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–¥—Ä–µ—Å–∞—Ç–æ–≤ (–ª–∏—á–µ–∫/–≥—Ä—É–ø–ø TG, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –±–æ—Ç —É–∂–µ ¬´–∑–Ω–∞–∫–æ–º¬ª).
* `/to <idx|name|@username>` ‚Äî –≤—ã–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏.
  –ü—Ä–∏–º–µ—Ä—ã:

  ```
  /to 1
  /to @mygroup
  /to myfriend
  ```

> –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/list` –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞—Ç–∞ –ø–æ `[–∏–Ω–¥–µ–∫—Å—É]`.

---

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1) –õ–∏—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ VK ‚áÑ Telegram-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

1. –í VK –Ω–∞–ø–∏—à–∏—Ç–µ –õ–° —Å–≤–æ–µ–º—É VK-–±–æ—Ç—É —Ç–æ–∫–µ–Ω TG-–±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123456789:AA...`).
2. –í Telegram –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω **—Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–∞—Ç—å /start –≤–∞—à–µ–º—É –±–æ—Ç—É** (–∏–Ω–∞—á–µ –±–æ—Ç –Ω–µ —Å–º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–∫—É).
3. –í VK –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/list` ‚Üí `/to <–∏–Ω–¥–µ–∫—Å>` –∏ –¥–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ –ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ –ª–∏—á–∫—É TG-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

### 2) –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç VK ‚áÑ –ì—Ä—É–ø–ø–∞ –≤ Telegram

1. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ TG-–±–æ—Ç–∞ –≤ –Ω—É–∂–Ω—É—é telegram-–≥—Ä—É–ø–ø—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–∞–º –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—á—Ç–æ–±—ã –±–æ—Ç ¬´—É–≤–∏–¥–µ–ª¬ª —á–∞—Ç).
2. –í VK –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/list`, —É–≤–∏–¥–∏—Ç–µ –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å–∞—Ç (–≥—Ä—É–ø–ø–∞).
3. –í—ã–±–µ—Ä–∏—Ç–µ `/to <–∏–Ω–¥–µ–∫—Å>` ‚Äî —Ç–µ–ø–µ—Ä—å —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∏–¥—Ç–∏ –≤ —Ç—É TG-–≥—Ä—É–ø–ø—É –∏ –æ–±—Ä–∞—Ç–Ω–æ.

---

## –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤

* **VK ‚Üí TG**: –≤—Å–µ –≤–ª–æ–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `sendDocument` (—Ñ–∞–π–ª).
* **TG ‚Üí VK**: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `photo`, `document`, `audio`, `voice`, `video`.
  –ú–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ VK –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç-–ø—Ä–µ—Ñ–∏–∫—Å –≤–∏–¥–∞ `[idx] name: (—Ñ–∞–π–ª)` –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–∞–º —Ñ–∞–π–ª.

> –ò–º–µ–Ω–∞ –≥—Ä—É–ø–ø –≤ TG. –°–∫—Ä–∏–ø—Ç –±–µ—Ä—ë—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∏–∑ –∞–ø–¥–µ–π—Ç–∞. –î–ª—è –≥—Ä—É–ø–ø Telegram –ª—É—á—à–µ –∑–∞—Ä–∞–Ω–µ–µ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞ ‚Äî —Ç–∞–∫ –∞–¥—Ä–µ—Å–∞—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è –≤ `/list`.

---

## –§–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è

* **`state.json`**:

  * `users[vkId]` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ VK: —Ç–µ–∫—É—â–∏–π TG-—Ç–æ–∫–µ–Ω, —Å–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–∞—Ç–æ–≤, –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å–∞—Ç, —Å—Ç–∞–¥–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞.
  * `tokens[tok]` ‚Äî —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ polling –¥–ª—è —Ç–æ–∫–µ–Ω–∞ TG (—Å–º–µ—â–µ–Ω–∏–µ `offset`, –ø—Ä–∏–∑–Ω–∞–∫ `polling`).

> –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ `state.json` –∏ —Ç–æ–∫–µ–Ω—ã –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö. –î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`.

---
